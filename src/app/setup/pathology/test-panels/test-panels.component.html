<div class="panels-container">
  <div class="header">
    <div class="header-content">
      <div class="d-flex">
        <div class="header-left">
          <div class="title-with-image">
            <h1 class="page-title">Test panels</h1>
          </div>
          <p class="page-subtitle">Manage and organize test panels</p>
        </div>
      </div>
      <div class="header-right">
        <button class="btn-add" (click)="addNew()">
          <i class="fa-solid fa-circle-plus"></i>
          Add new
        </button>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters">
    <div class="filters-row">
      <div class="filter-left">
        <input type="text" class="search" placeholder="Search by name or test..." [value]="searchTerm" (input)="onSearchChange($event)">
      </div>
      <div class="filter-right">
        <select class="category" [value]="selectedCategory" (change)="onCategoryChange($event)">
          <option value="All">All categories</option>
          <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
        </select>
        <button class="clear" (click)="clearFilters()">Clear</button>
      </div>
    </div>
  </div>

  <div class="table-wrapper" *ngIf="!isLoading; else loadingTpl">
    <table class="table-bordered">
      <thead>
        <tr>
          <th class="th-sr">SR. No</th>
          <th>NAME</th>
          <th>CATEGORY</th>
          <th>TESTS</th>
          <th></th>
          <th class="th-actions"> </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of panels; let i = index" class="table-row">
          <td class="order-col">
            
            <span class="order-dot">{{ i + 1 }}.</span>
          </td>
          <td class="name">
            <a href="javascript:void(0)" class="name-link" (click)="viewPanel(p)">{{ p.name }}</a>
          </td>
          <td class="category">{{ p.category }}</td>
          <td class="tests">
            <div class="ellipsis muted">{{ p.tests.join(', ') }}</div>
            <div class="small muted">({{ p.tests.length }} tests) <i class="fa-solid fa-caret-down"></i></div>
          </td>
          <td class="latest">
            <div class="ellipsis muted">&nbsp;</div>
          </td>
          <td class="actions">
            <button class="btn-view" (click)="viewPanel(p)"><i class="fas fa-eye"></i> View</button>
            <button class="btn-edit" (click)="editPanel(p)"><i class="fas fa-edit"></i> Edit</button>
            <button class="btn-delete" (click)="promptDelete(p)"><i class="fas fa-trash"></i> Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #loadingTpl>
    <div class="loading">Loading panels...</div>
  </ng-template>

  <!-- Delete Confirmation Modal -->
  <app-delete-confirmation-modal
    [show]="showDeleteConfirmation"
    [title]="'Delete Panel'"
    [message]="deleteMessage"
    [warningText]="'This action cannot be undone'"
    (confirmed)="confirmDelete()"
    (cancelled)="cancelDelete()">
  </app-delete-confirmation-modal>

  <!-- Delete Success Modal -->
  <app-delete-success-modal
    [show]="showDeleteSuccess"
    [title]="deleteSuccessTitle"
    [message]="'The panel has been successfully deleted.'"
    [badgeText]="'Operation completed'"
    [autoHideDelay]="1000"
    (closed)="onDeleteSuccessClosed()">
  </app-delete-success-modal>

</div>

